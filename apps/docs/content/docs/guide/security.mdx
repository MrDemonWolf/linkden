---
title: Security
description: How LinkDen protects your data with input sanitization, secure setup, and authentication.
---

# Security

LinkDen includes built-in protections against common web attacks. Most security measures work automatically -- this page explains what's covered and what you can configure.

## Secure Setup

The first-run setup wizard is protected by a one-time token to prevent unauthorized account creation.

1. When the server starts for the first time, a unique setup URL is printed to the **server console**.
2. Open that URL to access the setup wizard.
3. Once you complete setup, the token is automatically invalidated.
4. If the server restarts before setup finishes, a new token is generated.

The token is stored in memory only -- never written to disk or the database. After setup, the wizard page shows "Setup Already Completed" regardless of any token provided.

## Input Sanitization

LinkDen sanitizes all user-provided content on the server side before saving it. This protects against stored XSS attacks even if someone bypasses frontend validation.

**What gets sanitized:**

- **Text fields** (profile name, bio, titles, etc.) -- HTML tags are stripped and length limits are enforced.
- **URLs** -- Validated to ensure they use `http://` or `https://` protocols. Dangerous protocols like `javascript:` are rejected.
- **Colors** -- Must match `#RRGGBB` hex format.
- **Custom CSS** -- Script tags, `expression()` calls, `javascript:` URLs, and other known attack vectors are removed.
- **Contact form submissions** -- All text fields are stripped of HTML before storage.
- **Embed URLs** -- Validated against platform-specific patterns (e.g., YouTube, Spotify, SoundCloud).

## Authentication

LinkDen uses [Better Auth](https://www.better-auth.com/) for authentication with email and password.

- Sessions are signed with the `BETTER_AUTH_SECRET` environment variable.
- All admin routes require a valid session.
- Public routes are limited to page data, contact submissions, analytics tracking, vCard downloads, and setup.

## CORS

The API server checks the request origin against the `CORS_ORIGIN` environment variable. Only requests from your configured frontend URL are accepted.

Make sure `CORS_ORIGIN` matches your frontend URL exactly (including protocol, no trailing slash).

## CAPTCHA

The contact form supports optional CAPTCHA verification via Cloudflare Turnstile or Google reCAPTCHA. When configured, tokens are validated server-side before accepting submissions. See [Contact Form](/docs/guide/contact-form) for setup details.
