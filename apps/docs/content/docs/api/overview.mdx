---
title: API Overview
description: Understand LinkDen's API architecture built on tRPC and Hono running on Cloudflare Workers.
---

# API Overview

LinkDen's API is built with [tRPC](https://trpc.io/) v11 on top of [Hono](https://hono.dev/), running on Cloudflare Workers. This combination provides end-to-end type safety between the frontend and backend with edge performance.

## Architecture

```
Next.js Frontend (apps/web)
       |
       | tRPC Client (HTTP requests)
       |
       v
Hono Server (apps/server)
       |
       |-- Better Auth (session validation)
       |-- tRPC Router (packages/api)
       |
       v
Drizzle ORM (packages/db)
       |
       | SQL queries
       |
       v
Cloudflare D1 (SQLite)
```

### Hono

[Hono](https://hono.dev/) is an ultra-lightweight web framework designed for edge runtimes. It serves as the HTTP layer, handling routing, middleware, and request/response processing. Hono runs natively on Cloudflare Workers with zero cold start time.

### tRPC

[tRPC](https://trpc.io/) v11 provides end-to-end type safety without code generation. The frontend and backend share TypeScript types, so any API changes are caught at compile time. The router definitions live in `packages/api`.

### Better Auth

[Better Auth](https://www.better-auth.com/) handles authentication with email/password. Session cookies are validated on protected tRPC procedures. Public procedures skip authentication.

### Drizzle ORM

[Drizzle ORM](https://orm.drizzle.team/) provides a type-safe SQL query builder that works with Cloudflare D1 (SQLite). The schema is defined in `packages/db/src/schema/` and shared across the monorepo.

## API Routes

The tRPC router is organized into 10 sub-routers plus a top-level `healthCheck` query:

### Public Procedures (No Authentication)

| Procedure | Description |
|-----------|-------------|
| `public.getPage` | Get full public page data (profile, blocks, theme, settings) |
| `public.submitContact` | Submit a contact form message (validates CAPTCHA if configured) |
| `public.trackView` | Record a page view with referrer, user-agent, country |
| `public.trackClick` | Record a link click with block ID |
| `public.getVCard` | Download the vCard file (if enabled) |
| `public.getSetupStatus` | Check if setup is complete |
| `version.current` | Get current version |
| `version.checkUpdate` | Check for updates against GitHub releases |

### Protected Procedures (Better Auth Session Required)

| Router | Description |
|--------|-------------|
| `blocks.*` | CRUD operations for blocks (list, get, create, update, delete, reorder, toggleEnabled) |
| `settings.*` | Key-value settings management (get, getAll, update, updateBulk) |
| `contacts.*` | Contact form submissions (list, get, markRead, markUnread, delete, unreadCount) |
| `analytics.*` | Analytics queries (overview, viewsOverTime, clicksOverTime, topLinks, referrers, countries) |
| `social.*` | Social network management (list, toggle) |
| `wallet.*` | Apple Wallet config (getConfig, updateConfig, generatePreview) |
| `vcard.*` | vCard config (getConfig, updateConfig, preview) |
| `backup.*` | Data export/import (export, import) |

## Making API Calls

### From the Frontend

The tRPC client is configured in the Next.js app:

```typescript
import { trpc } from "@/utils/trpc";

// In a React component
const { data } = trpc.public.getPage.useQuery();
const { data: blocks } = trpc.blocks.list.useQuery();
```

## Error Handling

tRPC errors include:

- `UNAUTHORIZED` -- Missing or invalid session.
- `NOT_FOUND` -- Resource does not exist.
- `BAD_REQUEST` -- Invalid input (validated by Zod schemas from `packages/validators`).
- `INTERNAL_SERVER_ERROR` -- Unexpected server error.

All input is validated using shared Zod schemas from the `packages/validators` package, ensuring consistent validation between frontend forms and API endpoints.
