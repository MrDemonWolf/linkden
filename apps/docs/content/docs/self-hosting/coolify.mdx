---
title: Coolify Deployment
description: Deploy LinkDen on Coolify — a self-hosted PaaS with automatic SSL and a web dashboard.
---

# Coolify Deployment

Deploy LinkDen on [Coolify](https://coolify.io), an open-source, self-hosted platform that gives you a Heroku-like experience on your own server. You get automatic SSL, git-based deployments, and a web dashboard — all without vendor lock-in.

## Prerequisites

1. **A Coolify instance** running on a server. If you don't have one:
   - Minimum: 2 CPU cores, 2 GB RAM, 30 GB disk
   - Install with:
   ```bash
   curl -fsSL https://cdn.coollabs.io/coolify/install.sh | bash
   ```
   - Access the dashboard at `http://your-server-ip:8000`

2. **A domain name** (optional but recommended for SSL)
3. The LinkDen repository accessible from Coolify (public GitHub repo or connected private repo)

## Architecture

Coolify runs LinkDen as two Docker containers with a SQLite database on a persistent volume:

```
┌──────────────────────┐     ┌──────────────────────┐     ┌──────────────┐
│  Coolify Service:    │────▶│  Coolify Service:     │────▶│ SQLite File  │
│  Web App (Next.js    │     │  API Server (Hono     │     │ (persistent  │
│  static via Caddy)   │     │  on Node.js)          │     │  volume)     │
└──────────────────────┘     └──────────────────────┘     └──────────────┘
```

## Step 1: Prepare the Dockerfiles

Coolify deploys using Docker. You'll need `Dockerfile.api` and `Dockerfile.web` in the repository root, plus a Node.js entry point for the API.

> **Tip:** The complete Dockerfiles, `node-entry.ts`, and dependency install instructions are in the [Docker guide](/docs/self-hosting/docker). Follow the Dockerfile sections there, then come back here for the Coolify-specific setup.

## Step 2: Create the Project in Coolify

1. Open your Coolify dashboard.
2. Go to **Projects** and click **New Project**.
3. Name it `LinkDen` and click **Create**.
4. Click into the project and create a new **Environment** (e.g., `production`).

## Step 3: Deploy the API Service

1. In your project environment, click **New Resource**.
2. Select **Docker**.
3. Choose your source:
   - **GitHub**: Connect your account and select the LinkDen repository
   - **Public repository**: Enter the repository URL
4. Configure:
   - **Name**: `linkden-api`
   - **Dockerfile path**: `Dockerfile.api`
   - **Build context**: `.` (repository root)
   - **Port**: `8787`
5. Click **Deploy**.

> **Tip:** You can also deploy both services at once. Click **New Resource > Docker Compose** and point to the `docker-compose.yml` in the repository. Coolify detects both services automatically.

## Step 4: Deploy the Web App

If deploying services separately:

1. Click **New Resource** > **Docker**.
2. Configure:
   - **Name**: `linkden-web`
   - **Dockerfile path**: `Dockerfile.web`
   - **Build context**: `.` (repository root)
   - **Port**: `3001`
3. Add the build arguments (see Step 5).
4. Click **Deploy**.

## Step 5: Configure Environment Variables

In the Coolify dashboard, add variables to each service.

### API Service

| Variable | Value | Notes |
|----------|-------|-------|
| `BETTER_AUTH_SECRET` | `your-random-secret` | Mark as secret; generate with `openssl rand -base64 32` |
| `BETTER_AUTH_URL` | `https://api.yourdomain.com` | Base URL of the API server |
| `CORS_ORIGIN` | `https://yourdomain.com` | Must match web app URL exactly |
| `DATABASE_URL` | `file:/data/linkden.db` | SQLite file path |
| `RESEND_API_KEY` | `re_...` | Optional, mark as secret |
| `RESEND_FROM_EMAIL` | `contact@yourdomain.com` | Optional |
| `TURNSTILE_SECRET_KEY` | `0x...` | Optional, mark as secret |

### Web App (Build Arguments)

`NEXT_PUBLIC_*` variables must be set at **build time**. Add them as Build Arguments in Coolify:

| Argument | Value |
|----------|-------|
| `NEXT_PUBLIC_SERVER_URL` | `https://api.yourdomain.com` |
| `NEXT_PUBLIC_SITE_URL` | `https://yourdomain.com` |
| `NEXT_PUBLIC_SITE_NAME` | `LinkDen` |
| `NEXT_PUBLIC_TURNSTILE_SITE_KEY` | `0x...` (optional) |

## Step 6: Set Up Custom Domains

In the Coolify dashboard for each service:

1. Click the service > **Settings** (or **Domain** section).
2. Add your custom domain:
   - Web app: `yourdomain.com` or `links.yourdomain.com`
   - API: `api.yourdomain.com`

At your DNS provider, add A records pointing to your server:

| Type | Name | Target | TTL |
|------|------|--------|-----|
| A | `@` or `links` | `your-server-ip` | 300 |
| A | `api` | `your-server-ip` | 300 |

Coolify automatically provisions Let's Encrypt certificates once DNS propagates. No manual SSL configuration needed.

## Step 7: Persistent Storage for SQLite

If deploying via Docker Compose, the `linkden-data` volume is already defined. Coolify manages it automatically.

If deploying services separately:

1. Click the API service > **Storages** (or **Volumes**).
2. Add a persistent volume:
   - **Mount path**: `/data`
   - **Name**: `linkden-data`
3. Redeploy.

## Step 8: First-Time Setup

1. Check the API logs in Coolify (click the API service > **Logs**) for the setup URL:
   ```
   Setup URL: https://yourdomain.com/admin/setup?token=<unique-token>
   ```
2. Open the URL and create your admin account.
3. The token is invalidated after setup completes.
4. Sign in at `/admin/login`.

## Updating

### Automatic Deployments

1. Go to your service settings.
2. Enable **Automatic deployments**.
3. Select the branch to watch (e.g., `main`).

Coolify rebuilds and redeploys whenever you push to that branch.

### Manual Redeployment

Click **Redeploy** on the service page in the Coolify dashboard.

## Backups

Back up the SQLite database regularly:

```bash
docker exec <api-container-id> sqlite3 /data/linkden.db ".backup /data/backup.db"
docker cp <api-container-id>:/data/backup.db ./linkden-backup-$(date +%Y%m%d).db
```

Or set up a cron job on the host for daily backups:

```bash
# Add to crontab: daily backup at 2 AM
0 2 * * * docker exec linkden-api sqlite3 /data/linkden.db ".backup /data/backup.db" && cp /var/lib/docker/volumes/linkden-data/_data/backup.db /backups/linkden-$(date +\%Y\%m\%d).db
```

## Troubleshooting

### Container exits immediately

Check the logs in Coolify (service > **Logs**). Common causes: missing environment variables, port conflict, Dockerfile syntax error.

### API cannot connect to the database

- Verify the persistent volume is mounted at `/data`
- Ensure `DATABASE_URL=file:/data/linkden.db`

### Web app shows "Failed to fetch" or API errors

- `NEXT_PUBLIC_SERVER_URL` must be set at **build time** — changing it requires a rebuild
- `CORS_ORIGIN` must exactly match the web app's domain

### SSL certificate not provisioning

- DNS records must point to your Coolify server IP
- Ports 80 and 443 must be open
- Wait a few minutes for DNS propagation

### "Database is locked" errors

SQLite allows only one write at a time. If you see this under load:
- Enable WAL mode: `PRAGMA journal_mode=WAL;`
- Consider using Turso (managed libSQL) for better concurrency
